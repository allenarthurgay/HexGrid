<html>
	<body onload="render();">
		<canvas id="canvas" width="320" height="240" style="border: 1px solid #000">
		</canvas>
        <script type="text/javascript" src="glMatrix-0.9.5.min.js"></script>
		<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.1/jquery.min.js"></script>

        <script id="shader-fs" type="x-shader/x-fragment">
            precision mediump float;

            void main(void) {
                gl_FragColor = vec4(1.0, 1.0, 1.0, 1.0);
            }
        </script>

        <script id="shader-vs" type="x-shader/x-vertex">
            attribute vec3 aVertexPosition;

            uniform mat4 uMVMatrix;

            void main(void) {
                gl_Position = uMVMatrix * vec4(aVertexPosition, 1.0);
            }
        </script>

        <script type="text/javascript" src="hexgrid.js"></script>
		<script type="text/javascript">
			var generatedMap = [];

			for(var i=0; i < 5; i++){
				for(var j=0; j < 5; j++){
					generatedMap.push({ x: i, y: j, z: 0});
				}
			}

		</script>
		<script type="text/javascript">
			var size = 25;
			$('#canvas').click(function(e){

				var x = e.pageX - this.offsetLeft;
				var y = e.pageY - this.offsetTop;

				var hex = hexGrid.findByPixel(x, y);

				if(!hex){
					return;
				}
				if(hex.color == 'white'){
					hex.color = 'green';
				}
				else{
					hex.color = 'white';
				}

			});

			function takeadump(){
				$('#mapDumpee').text(JSON.stringify(hexGrid.getMap()));
			}
		//	$('#saveMap').click(function(){
		//		alert(1)
		//	})

            // thanks javascript % bug...
            // taken from: http://javascript.about.com/od/problemsolving/a/modulobug.htm
            Number.prototype.mod = function(n) {
                return ((this%n)+n)%n;
            }

			var c = document.getElementById('canvas');

            var gridWidth = 7;
            var gridHeight = 6;

            var hexGrid = new HexGrid(c);
            hexGrid.loadMap(generatedMap);


			function render() {
                hexGrid.renderOneFrame();
				window.setTimeout(render, 80);
			}

			var SQRT_3_2 = 0.8660254037844386;

		</script>
		      <br/><br/>        <br/><br/>   <br/><br/>
	<button id='saveMap' onclick="takeadump()">Dump map data</button>        <br/><br/>   <br/><br/>
	<textarea id='mapDumpee' style='width:300px;height:300px;'></textarea>
	</body>
</html>

